-- ELIMINAÇÃO DE TABELAS
/*
DROP TABLE T_INVESTIMENTO;
DROP TABLE T_DESPESA;
DROP TABLE T_RECEBIMENTO;
DROP TABLE T_TIPO_INVESTIMENTO;
DROP TABLE T_TIPO_DESPESA;
DROP TABLE T_TIPO_RECEBIMENTO;
DROP TABLE T_SERVICO;
DROP TABLE T_TRANSFERENCIA;
DROP TABLE T_TIPO_CONTA;
DROP TABLE T_CONTA;
DROP TABLE T_USUARIO;*/


-- CRIAÇÃO DAS TABELAS
CREATE TABLE T_USUARIO (
    cd_usuario INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    nm_usuario VARCHAR2(20) NOT NULL,
    sobrenome_usuario VARCHAR2(80) NOT NULL,
    dt_nasc_usuario DATE NOT NULL,
    email_usuario VARCHAR2(30) NOT NULL,
    senha_usuario VARCHAR2(15) NOT NULL
);


ALTER TABLE T_USUARIO ADD CONSTRAINT PK_CD_USUARIO PRIMARY KEY (cd_usuario);


CREATE TABLE T_TIPO_CONTA (
    cd_tipo_conta INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    tipo_conta VARCHAR2(30) NOT NULL
);


ALTER TABLE T_TIPO_CONTA ADD CONSTRAINT PK_CD_TIPO_CONTA PRIMARY KEY (cd_tipo_conta);


CREATE TABLE T_CONTA (
    cd_conta INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    nm_conta VARCHAR2(30) NOT NULL,
    cd_usuario INTEGER NOT NULL,
    dsc_conta VARCHAR2(120),
    cd_tipo_conta INTEGER NOT NULL,
    saldo_conta NUMBER(10,2) NOT NULL
);

ALTER TABLE T_CONTA ADD CONSTRAINT PK_CD_CONTA PRIMARY KEY (cd_conta);

ALTER TABLE T_CONTA ADD CONSTRAINT FK_CD_USUARIO FOREIGN KEY (cd_usuario)
REFERENCES T_USUARIO (cd_usuario);

ALTER TABLE T_CONTA ADD CONSTRAINT FK_CD_TIPO_CONTA FOREIGN KEY (cd_tipo_conta)
REFERENCES T_TIPO_CONTA (cd_tipo_conta);



CREATE TABLE T_TRANSFERENCIA (
    cd_transferencia INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    cd_conta_beneficiaria INTEGER NOT NULL,
    cd_conta_beneficiada INTEGER NOT NULL,
    vl_transferencia NUMBER(10,2) NOT NULL,
    dt_transferencia DATE NOT NULL
);

ALTER TABLE T_TRANSFERENCIA ADD CONSTRAINT PK_CD_TRANSFERENCIA PRIMARY KEY (cd_transferencia);

ALTER TABLE T_TRANSFERENCIA ADD CONSTRAINT FK_CD_CONTA_BENEFICIARIA FOREIGN KEY (cd_conta_beneficiaria)
REFERENCES T_CONTA (cd_conta);

ALTER TABLE T_TRANSFERENCIA ADD CONSTRAINT FK_CD_CONTA_BENEFICIADA FOREIGN KEY (cd_conta_beneficiada)
REFERENCES T_CONTA (cd_conta);


CREATE TABLE T_SERVICO (
    cd_servico INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    cd_conta INTEGER NOT NULL,
    nm_servico VARCHAR2(30) NOT NULL,
    vl_servico NUMBER(10,2) NOT NULL,
    dt_servico DATE NOT NULL,
    dsc_servico VARCHAR2(120)
);

ALTER TABLE T_SERVICO ADD CONSTRAINT PK_CD_SERVICO PRIMARY KEY (cd_servico);

ALTER TABLE T_SERVICO ADD CONSTRAINT FK_CD_CONTA FOREIGN KEY (cd_conta)
REFERENCES T_CONTA (cd_conta);


--- TABELAS REFERENTES A INVESTIMENTO
CREATE TABLE T_TIPO_INVESTIMENTO (
    cd_tipo_investimento INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    tipo_investimento VARCHAR2(20) NOT NULL
);

ALTER TABLE T_TIPO_INVESTIMENTO ADD CONSTRAINT PK_CD_TIPO_INVESTIMENTO PRIMARY KEY (cd_tipo_investimento);


CREATE TABLE T_INVESTIMENTO (
    cd_investimento INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    cd_servico INTEGER NOT NULL,
    cd_tipo_investimento INTEGER NOT NULL
);

ALTER TABLE T_INVESTIMENTO ADD CONSTRAINT PK_CD_INVESTIMENTO PRIMARY KEY (cd_investimento);

ALTER TABLE T_INVESTIMENTO ADD CONSTRAINT FK_CD_SERVICO_INVESTIMENTO FOREIGN KEY (cd_servico)
REFERENCES T_SERVICO (cd_servico);

ALTER TABLE T_INVESTIMENTO ADD CONSTRAINT FK_CD_TIPO_INVESTIMENTO FOREIGN KEY (cd_tipo_investimento)
REFERENCES T_TIPO_INVESTIMENTO (cd_tipo_investimento);



--- TABELAS REFERENTES A RECEBIMENTO
CREATE TABLE T_TIPO_RECEBIMENTO (
    cd_tipo_recebimento INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    tipo_recebimento VARCHAR2(20) NOT NULL
);

ALTER TABLE T_TIPO_RECEBIMENTO ADD CONSTRAINT PK_CD_TIPO_RECEBIMENTO PRIMARY KEY (cd_tipo_recebimento);


CREATE TABLE T_RECEBIMENTO (
    cd_recebimento INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    cd_servico INTEGER NOT NULL,
    cd_tipo_recebimento INTEGER NOT NULL
);

ALTER TABLE T_RECEBIMENTO ADD CONSTRAINT PK_CD_RECEBIMENTO PRIMARY KEY (cd_recebimento);

ALTER TABLE T_RECEBIMENTO ADD CONSTRAINT FK_CD_SERVICO_RECEBIMENTO FOREIGN KEY (cd_servico)
REFERENCES T_SERVICO (cd_servico);

ALTER TABLE T_RECEBIMENTO ADD CONSTRAINT FK_CD_TIPO_RECEBIMENTO FOREIGN KEY (cd_tipo_recebimento)
REFERENCES T_TIPO_RECEBIMENTO (cd_tipo_recebimento);



--- TABELAS REFERENTES A DESPESA
CREATE TABLE T_TIPO_DESPESA (
    cd_tipo_despesa INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    tipo_despesa VARCHAR2(20) NOT NULL
);

ALTER TABLE T_TIPO_DESPESA ADD CONSTRAINT PK_CD_TIPO_DESPESA PRIMARY KEY (cd_tipo_despesa);


CREATE TABLE T_DESPESA (
    cd_despesa INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    cd_servico INTEGER NOT NULL,
    cd_tipo_despesa INTEGER NOT NULL
);

ALTER TABLE T_DESPESA ADD CONSTRAINT PK_CD_DESPESA PRIMARY KEY (cd_despesa);

ALTER TABLE T_DESPESA ADD CONSTRAINT FK_CD_SERVICO_DESPESA FOREIGN KEY (cd_servico)
REFERENCES T_SERVICO (cd_servico);

ALTER TABLE T_DESPESA ADD CONSTRAINT FK_CD_TIPO_DESPESA FOREIGN KEY (cd_tipo_despesa)
REFERENCES T_TIPO_DESPESA (cd_tipo_despesa);














